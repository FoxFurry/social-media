(this["webpackJsonpsocial-media"]=this["webpackJsonpsocial-media"]||[]).push([[0],{36:function(e,t,a){},48:function(e,t,a){},49:function(e,t,a){},50:function(e,t,a){},58:function(e,t,a){},59:function(e,t,a){},60:function(e,t,a){},61:function(e,t,a){},81:function(e,t,a){},82:function(e,t,a){},83:function(e,t,a){"use strict";a.r(t);var n=a(2),c=a(7),o=a(9),i=a(40),s={isLoggedIn:!!localStorage.getItem("token"),userInfo:{token:localStorage.getItem("token"),userId:localStorage.getItem("userId"),email:localStorage.getItem("email"),photoUrl:localStorage.getItem("photoUrl"),displayName:localStorage.getItem("displayName")},isErrorEmailExists:!1,isPasswordValid:!1,isErrorEmailNotFound:!1},r=Object(i.a)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN":return Object(o.a)(Object(o.a)({},e),{},{userInfo:{token:t.payload.token,userId:t.payload.userId,email:t.payload.email},isLoggedIn:!0});case"SET_USER_INFO":return Object(o.a)(Object(o.a)({},e),{},{userInfo:{photoUrl:t.payload.photoUrl,displayName:t.payload.displayName}});case"LOGOUT":return Object(o.a)(Object(o.a)({},e),{},{userInfo:{token:"",userId:"",email:"",photoUrl:"",displayName:""},isLoggedIn:!1});case"CHANGE_NAME":return Object(o.a)(Object(o.a)({},e),{},{displayName:t.displayName});case"EMAIL_EXISTS":return Object(o.a)(Object(o.a)({},e),{},{isErrorEmailExists:t.boolean});case"EMAIL_NOT_FOUND":return Object(o.a)(Object(o.a)({},e),{},{isErrorEmailNotFound:t.boolean});case"INVALID_PASSWORD":return Object(o.a)(Object(o.a)({},e),{},{isPasswordValid:t.boolean});default:return e}})),l=a(26),u=a.n(l),j=(a(48),a(49),a(6)),d=a(12),f=a(15),b=(a(50),a.p+"static/media/user.c9207524.png"),p=function(e){var t=(new Date).getTime();return new Date(e).getTime()-t},h=function(){Object(c.c)((function(e){return e.userInfo}));var e=Object(d.g)(),t=Object(c.b)(),a=function(){var e=localStorage.getItem("expirationTime"),t=p(e);return t<=6e4?(localStorage.removeItem("token"),localStorage.removeItem("expirationTime"),null):t}(),o=Object(n.useState)(localStorage.getItem("expirationTime")),i=Object(j.a)(o,2),s=i[0],r=i[1],l=function(a,n,c,o){"https://identitytoolkit.googleapis.com/v1/accounts:signUp?key=AIzaSyBSIZSdghkjvJ_8hJt-FAicfpHNpUAVsPI"===o?(localStorage.setItem("displayName",c.substring(0,c.indexOf("@"))),localStorage.setItem("photoUrl",b),t({type:"SET_USER_INFO",payload:{displayName:c.substring(0,c.indexOf("@")),photoUrl:b}}),fetch("https://react-http-560ff-default-rtdb.firebaseio.com/users/".concat(n,".json?auth=").concat(a),{method:"PUT",body:JSON.stringify({email:c,displayName:c.substring(0,c.indexOf("@")),photoUrl:""}),headers:{"Content-Type":"application/json"}}).then((function(e){if(e.ok)return e.json();console.log(e)})).catch((function(e){console.log(e)}))):fetch("https://react-http-560ff-default-rtdb.firebaseio.com/users/".concat(n,".json?auth=").concat(a)).then((function(e){if(e.ok)return e.json();console.log(e),e.json().then((function(e){}))})).then((function(e){var a="";a=""===e.photoUrl?b:e.photoUrl,localStorage.setItem("displayName",e.displayName),localStorage.setItem("photoUrl",a),t({type:"SET_USER_INFO",payload:{displayName:e.displayName,photoUrl:a}})})).catch((function(e){console.log(e.message)})),e.replace("/feed")},u=Object(n.useCallback)((function(){localStorage.clear(),t({type:"LOGOUT"}),s&&clearTimeout(s)}),[s,t]);return Object(n.useEffect)((function(){a&&r(setTimeout(u,a))}),[r]),{login:function(e,a,n){fetch(e,{method:"POST",body:JSON.stringify({email:a,password:n,returnSecureToken:!0}),headers:{"Content-Type":"application/json"}}).then((function(e){if(e.ok)return t({type:"IS_ERROR",boolean:!1}),e.json();e.json().then((function(e){"EMAIL_EXISTS"===e.error.message&&t({type:"EMAIL_EXISTS",boolean:!0}),"EMAIL_NOT_FOUND"===e.error.message&&t({type:"EMAIL_NOT_FOUND",boolean:!0}),"INVALID_PASSWORD"===e.error.message&&t({type:"INVALID_PASSWORD",boolean:!0}),console.log(e.error)}))})).then((function(a){t({type:"LOGIN",payload:{token:a.idToken,userId:a.localId,email:a.email}}),localStorage.setItem("token",a.idToken),localStorage.setItem("userId",a.localId),localStorage.setItem("email",a.email);var n=new Date((new Date).getTime()+1e3*+a.expiresIn);localStorage.setItem("expirationTime",n.toISOString());var c=p(n);return r(setTimeout(u,c)),l(a.idToken,a.localId,a.email,e)})).catch((function(e){console.log(e.message)}))},logout:u}},m=a.p+"static/media/hamburger.ab2c8b29.svg",O=a(3),g=function(){var e=Object(d.g)(),t=Object(c.c)((function(e){return e.isLoggedIn})),a=Object(c.c)((function(e){return e.userInfo.photoUrl})),o=Object(c.c)((function(e){return e.userInfo.displayName})),i=Object(n.useState)(!0),s=Object(j.a)(i,2),r=s[0],l=s[1],u=Object(n.useState)(!1),b=Object(j.a)(u,2),p=b[0],g=b[1],x=h().logout;return Object(n.useEffect)((function(){l(void 0===o||void 0===a)}),[o,a]),Object(O.jsx)("header",{className:t&&p?"expand-header":"",children:Object(O.jsxs)("nav",{className:"header-nav  ".concat(t?"header-nav-mobile":""),children:[t&&Object(O.jsx)("button",{className:"header-nav-menu ".concat(p?"fade-menu":""),onClick:function(){g((function(e){return!e}))},children:Object(O.jsx)("img",{src:m})}),Object(O.jsxs)("ul",{className:"header-nav-list ".concat(!p&&t?"hide-menu":""," ").concat(t?"header-nav-list-logged":""),children:[t&&Object(O.jsx)("li",{className:"header-nav-feed ",children:Object(O.jsx)(f.b,{to:"/feed",children:"Feed"})}),t&&(r?Object(O.jsx)("p",{children:"Loading..."}):Object(O.jsx)("li",{children:Object(O.jsxs)(f.b,{to:"/profile",className:"header-nav-profile",children:[Object(O.jsx)("div",{className:"header-div-avatar",children:Object(O.jsx)("img",{src:a})}),o]})})),t&&Object(O.jsx)("li",{className:"header-nav-button-container",children:Object(O.jsx)("button",{onClick:function(){x(),e.replace("/")},className:"header-nav-button",children:"Logout"})}),!t&&Object(O.jsx)("li",{className:"header-nav-login",children:Object(O.jsx)(f.b,{to:"/login",children:"Login"})}),!t&&Object(O.jsx)("li",{className:"header-nav-signup",children:Object(O.jsx)(f.b,{to:"/signup",children:"Sign up"})})]})]})})},x=(a(36),function(){var e=h().login,t=Object(c.b)(),a=Object(n.useRef)(),o=Object(n.useRef)(),i=Object(c.c)((function(e){return e.isErrorEmailNotFound})),s=Object(c.c)((function(e){return e.isPasswordValid}));return Object(O.jsxs)("form",{onSubmit:function(n){n.preventDefault();var c=a.current.value,i=o.current.value;t({type:"EMAIL_NOT_FOUND",boolean:!1}),t({type:"INVALID_PASSWORD",boolean:!1}),e("https://identitytoolkit.googleapis.com/v1/accounts:signInWithPassword?key=AIzaSyBSIZSdghkjvJ_8hJt-FAicfpHNpUAVsPI",c,i)},className:"authentification-form",children:[Object(O.jsx)("div",{className:"authentification-form__name",children:Object(O.jsx)("h1",{children:"Login"})}),Object(O.jsxs)("div",{className:"authentification-form__inputs",children:[Object(O.jsx)("input",{className:i?"invalid":"",type:"email",ref:a,placeholder:"Email",required:!0}),i&&Object(O.jsx)("p",{className:"authentification-form__invalid",children:"Invalid email"}),Object(O.jsx)("input",{className:s?"invalid":"",type:"password",ref:o,placeholder:"Password",required:!0}),s&&Object(O.jsx)("p",{className:"authentification-form__invalid",children:"Invalid password"}),Object(O.jsxs)("div",{className:"authentification-form__actions",children:[Object(O.jsx)("input",{type:"submit",className:"authentification-form__submit",value:"Sign in"}),Object(O.jsx)(f.b,{to:"/signup",className:"authentification-form__link",children:"Create account"})]})]})]})}),v=function(){var e=Object(c.b)(),t=h().login,a=Object(c.c)((function(e){return e.isErrorEmailExists})),o=Object(n.useState)(""),i=Object(j.a)(o,2),s=i[0],r=i[1],l=Object(n.useState)(""),u=Object(j.a)(l,2),d=u[0],b=u[1],p=Object(n.useState)(""),m=Object(j.a)(p,2),g=m[0],x=m[1],v=Object(n.useState)(),N=Object(j.a)(v,2),I=N[0],S=N[1],_=Object(n.useState)(),y=Object(j.a)(_,2),E=y[0],k=y[1],D=Object(n.useState)(),T=Object(j.a)(D,2),U=T[0],L=T[1],w=Object(n.useState)(!1),P=Object(j.a)(w,2),A=P[0],R=P[1],C=function(){var e=new RegExp(/^(("[\w-\s]+")|([\w-]+(?:\.[\w-]+)*)|("[\w-\s]+")([\w-]+(?:\.[\w-]+)*))(@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$)|(@\[?((25[0-5]\.|2[0-4][0-9]\.|1[0-9]{2}\.|[0-9]{1,2}\.))((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\.){2}(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\]?$)/i);return L(!e.test(s)),S(d!==g),k(d.length<6),I||E||U};Object(n.useEffect)((function(){R(C())}),[C]);return Object(O.jsxs)("form",{onSubmit:function(e){e.preventDefault(),A||t("https://identitytoolkit.googleapis.com/v1/accounts:signUp?key=AIzaSyBSIZSdghkjvJ_8hJt-FAicfpHNpUAVsPI",s,d)},className:"authentification-form",children:[Object(O.jsx)("div",{className:"authentification-form__name",children:Object(O.jsx)("h1",{children:"Sign up"})}),Object(O.jsxs)("div",{className:"authentification-form__inputs",children:[Object(O.jsx)("input",{className:a||U?"invalid":"",type:"email",value:s,onChange:function(t){e({type:"EMAIL_EXISTS",boolean:!1}),r(t.target.value)},required:!0}),a&&Object(O.jsx)("p",{className:"authentification-form__invalid",children:"Email exists already"}),U&&Object(O.jsx)("p",{className:"authentification-form__invalid",children:"Email is not valid"}),Object(O.jsx)("input",{className:E?"invalid":"",type:"password",value:d,onChange:function(e){b(e.target.value)},required:!0}),E&&Object(O.jsx)("p",{className:"authentification-form__invalid",children:"Password is shorter than 6 characters"}),Object(O.jsx)("input",{className:I?"invalid":"",type:"password",value:g,onChange:function(e){x(e.target.value)},required:!0}),I&&Object(O.jsx)("p",{className:"authentification-form__invalid",children:"Passwords do not match"}),Object(O.jsxs)("div",{className:"authentification-form__actions",children:[Object(O.jsx)("input",{type:"submit",value:"Sign up",className:"authentification-form__submit",disabled:A}),Object(O.jsx)(f.b,{to:"/login",className:"authentification-form__link",children:"Have account already?"})]})]})]})},N=function(){var e=Object(d.h)();return Object(O.jsx)("div",{children:"/login"===e.pathname?Object(O.jsx)(x,{}):Object(O.jsx)(v,{})})},I=a(35);I.a.initializeApp({apiKey:" AIzaSyBSIZSdghkjvJ_8hJt-FAicfpHNpUAVsPI ",authDomain:"https://react-http-560ff-default-rtdb.firebaseapp.com",projectId:"react-http-560ff",storageBucket:"react-http-560ff.appspot.com",messagingSenderId:"",appId:""});var S=I.a,_=(a(58),a(39)),y=(a(59),function(e){var t=e.data,a=e.dispatch,c=Object(n.useRef)(),o=Object(n.useState)(""),i=Object(j.a)(o,2),s=i[0],r=i[1];Object(n.useEffect)((function(){e.sent&&r("")}),[e.sent]);return Object(O.jsx)("textarea",{rows:"4",cols:"50",className:t.inDropZone?"drag-drop-zone inside-drag-area":"drag-drop-zone",onDrop:function(e){e.preventDefault();var t=Object(_.a)(e.dataTransfer.files);if(t[0].type.match(/image.*/)&&t&&t.length>0){console.log(URL.createObjectURL(t[0]));var n=t[0];a({type:"ADD_FILE",fileUpload:n}),a({type:"SET_DROP_DEPTH",dropDepth:0}),a({type:"SET_IN_DROP_ZONE",inDropZone:!1})}},onDragOver:function(e){e.preventDefault(),e.dataTransfer.dropEffect="copy",a({type:"SET_IN_DROP_ZONE",inDropZone:!0})},onDragEnter:function(e){e.preventDefault(),a({type:"SET_DROP_DEPTH",dropDepth:t.dropDepth+1})},onDragLeave:function(e){e.preventDefault(),a({type:"SET_DROP_DEPTH",dropDepth:t.dropDepth-1}),a({type:"SET_IN_DROP_ZONE",inDropZone:!1})},ref:c,onChange:function(e){r(e.target.value);var t=c.current.value;a({type:"ADD_TEXT",text:t})},value:s,placeholder:"Add text,image or gif ..."})}),E=(a(60),a.p+"static/media/heart.7da58c3c.svg"),k=(a(61),function(e){var t=localStorage.getItem("token"),a=localStorage.getItem("userId"),c=Object(n.useState)(!1),o=Object(j.a)(c,2),i=o[0],s=o[1],r=Object(n.useState)(Object.keys(e.likes).length),l=Object(j.a)(r,2),u=l[0],d=l[1],b=Object(n.useState)(""),p=Object(j.a)(b,2),h=p[0],m=p[1],g=Object(n.useState)(!0),x=Object(j.a)(g,2),v=x[0],N=x[1];return Object(n.useEffect)((function(){for(var t in e.likes)for(var n in e.likes[t])if(e.likes[t][n]===a){m(n),s(!0);break}}),[]),v&&Object(O.jsxs)("div",{className:"post-card",children:[Object(O.jsxs)("div",{className:"post-card__heading",children:[Object(O.jsx)(f.b,{to:"/user/".concat(e.userId),children:e.displayName}),Object(O.jsx)("div",{children:e.ownProfile&&Object(O.jsx)("button",{className:"post-card__heading__delete",onClick:function(){window.confirm("Your post will be deleted")&&(N(!1),fetch("https://react-http-560ff-default-rtdb.firebaseio.com/posts/".concat(e.userId,"/").concat(e.id,".json?auth=").concat(t),{method:"DELETE"}).then((function(e){if(e.ok)return e.json();e.json().then((function(e){console.log(e)}))})))},children:"x"})})]}),Object(O.jsxs)("div",{className:"post-card__content",children:[Object(O.jsx)("div",{className:"post-card__text",children:e.text}),e.imageURL&&Object(O.jsx)("div",{className:"post-card__image",children:Object(O.jsx)("img",{src:e.imageURL})})]}),Object(O.jsxs)("div",{className:"post-card__likes",children:[Object(O.jsx)("button",{onClick:function(){i?(s(!1),fetch("https://react-http-560ff-default-rtdb.firebaseio.com/liked/".concat(e.id,"/").concat(h,"/.json"),{method:"DELETE"}).then((function(e){return e.json()})).then((function(e){m(""),d((function(e){return e-1}))}))):(s(!0),fetch("https://react-http-560ff-default-rtdb.firebaseio.com/liked/".concat(e.id,".json"),{method:"POST",body:JSON.stringify(localStorage.getItem("userId")),headers:{"Content-Type":"application/json"}}).then((function(e){if(e.ok)return console.log(e),d((function(e){return e+1})),e.json();e.json().then((function(e){console.log(e)}))})))},children:Object(O.jsx)("img",{src:E,className:i?"liked":""})}),e.likes&&u]})]})}),D=a(28),T=a.n(D),U=function(e){var t=Object(d.h)(),a=localStorage.getItem("userId"),o=Object(c.c)((function(e){return e.userInfo.displayName})),i=Object(n.useState)([]),s=Object(j.a)(i,2),r=s[0],l=s[1],u=Object(n.useState)(!0),f=Object(j.a)(u,2),b=f[0],p=f[1],h=[],m=[];Object(n.useEffect)((function(){if(p(!0),fetch("https://react-http-560ff-default-rtdb.firebaseio.com/liked.json").then((function(e){return e.json()})).then((function(e){m=e})),"/profile"===t.pathname)return g(a);var n=e.currentUserId;return g(n)}),[fetch,e.displayName,o,a]);var g=function(t){var a=[];fetch("https://react-http-560ff-default-rtdb.firebaseio.com/posts/".concat(t,".json")).then((function(e){return e.json()})).then((function(n){for(var c in n){for(var o in h=[],m)o===c&&h.push(m[o]);a.push({id:c,text:n[c].text,imageURL:n[c].imageURL,userId:t,displayName:e.displayName,likes:h})}l(a),p(!1)}))},x=r.map((function(t){return Object(O.jsx)(k,{id:t.id,text:t.text,imageURL:t.imageURL,userId:t.userId,displayName:t.displayName,likes:t.likes,ownProfile:e.ownProfile},t.id)})).reverse();return Object(O.jsx)("div",{className:"post-list-container",children:b?Object(O.jsx)(T.a,{type:"TailSpin",color:"#585d99",height:100,width:100}):x})},L=function(e,t){switch(t.type){case"ADD_TEXT":return Object(o.a)(Object(o.a)({},e),{},{text:t.text});case"SET_DROP_DEPTH":return Object(o.a)(Object(o.a)({},e),{},{dropDepth:t.dropDepth});case"SET_IN_DROP_ZONE":return Object(o.a)(Object(o.a)({},e),{},{inDropZone:t.inDropZone});case"ADD_FILE":return Object(o.a)(Object(o.a)({},e),{},{file:t.fileUpload});case"DELETE_FILE":return Object(o.a)(Object(o.a)({},e),{},{file:{}});default:return e}},w=function(e){var t=null,a=Object(c.c)((function(e){return e.userInfo.token})),o=Object(c.c)((function(e){return e.userInfo.userId})),i=Object(c.c)((function(e){return e.userInfo.photoUrl})),s=Object(c.c)((function(e){return e.userInfo.displayName})),r=Object(n.useState)(!0),l=Object(j.a)(r,2),u=l[0],d=l[1],f=Object(n.useState)(!1),b=Object(j.a)(f,2),p=b[0],h=b[1],m=Object(n.useState)(0),g=Object(j.a)(m,2),x=g[0],v=g[1],N=Object(n.useState)(!1),I=Object(j.a)(N,2),_=I[0],E=I[1],k=Object(n.useReducer)(L,{text:"",dropDepth:0,inDropZone:!1,file:{}}),D=Object(j.a)(k,2),T=D[0],U=D[1],w=T.file,P=T.text;Object(n.useEffect)((function(){d(void 0===i||void 0===s)}),[i,s]);var A=function(n,c){return fetch("https://react-http-560ff-default-rtdb.firebaseio.com/posts/".concat(o,".json?auth=").concat(a),{method:"POST",body:JSON.stringify({text:n,imageURL:c}),headers:{"Content-Type":"application/json"}}).then((function(e){if(e.ok)return h(!0),E(!0),t=setTimeout((function(){E(!1)}),3e3),U({type:"DELETE_FILE"}),e.json();e.json().then((function(e){console.log(e)}))})).then((function(t){e.sendPost()})),function(){return clearTimeout(t)}};return Object(O.jsxs)("div",{className:"post-form__container",children:[u?Object(O.jsx)("p",{children:"Loading..."}):Object(O.jsxs)("div",{className:"post-form__heading",children:[Object(O.jsx)("div",{className:"post-form__avatar",children:Object(O.jsx)("img",{src:i,alt:"profile pic"})}),Object(O.jsx)("div",{className:"post-form__name",children:s})]}),Object(O.jsxs)("form",{className:"post-form__form",onSubmit:function(e){if(v(0),e.preventDefault(),h(!1),!(P.length<1))if(P.length>300)v(P.length);else if(w.name){var t=S.storage().ref().child("postsImage/".concat(o,"/").concat(w.name)).put(w);console.log(w),t.on(S.storage.TaskEvent.STATE_CHANGED,(function(e){}),(function(e){throw e}),(function(){t.snapshot.ref.getDownloadURL().then((function(e){A(P,e)}))}))}else A(P,"")},children:[_&&Object(O.jsx)("div",{className:"post-form__message",children:"Posted!"}),Object(O.jsx)(y,{data:T,dispatch:U,sent:p}),w.name&&Object(O.jsxs)("div",{className:"post-form__dropped-file",children:[Object(O.jsx)("button",{className:"post-form__dropped-file__undo",onClick:function(){U({type:"DELETE_FILE"})},children:"x"}),Object(O.jsx)("img",{src:URL.createObjectURL(w),alt:w.name})]}),x>300&&Object(O.jsxs)("p",{children:["Only 300 characters allowed, you have ",x]}),Object(O.jsx)("input",{type:"submit",className:"post-form__submit",value:"Post"})]})]})},P=a(34),A=a.n(P),R=a(38),C=(a(81),function(e){var t=Object(n.useState)([]),a=Object(j.a)(t,2),i=a[0],s=a[1],r=Object(n.useState)(!0),l=Object(j.a)(r,2),u=l[0],d=l[1],f=Object(c.c)((function(e){return e.userInfo.token})),b=Object(n.useCallback)(Object(R.a)(A.a.mark((function e(){var t,a,n;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:d(!0),t=[],a=[],n=[],fetch("https://react-http-560ff-default-rtdb.firebaseio.com/users.json?auth=".concat(f)).then((function(e){return e.json()})).then((function(e){for(var c in e)t.push({id:c,displayName:e[c].displayName});return fetch("https://react-http-560ff-default-rtdb.firebaseio.com/liked.json").then((function(e){return e.json()})).then((function(e){return a=e,console.log(a),fetch("https://react-http-560ff-default-rtdb.firebaseio.com/posts.json").then((function(e){return e.json()})).then((function(e){var c=[];for(var i in e){var r="";for(var l in t)t[l].id===i&&(r=t[l]);for(var u in e[i]){for(var j in n=[],a)j===u&&n.push(a[j]);c.push(Object(o.a)(Object(o.a)({},e[i][u]),{},{id:u,userId:i,displayName:r.displayName,likes:n}))}}s(c)}))}))}));case 5:case"end":return e.stop()}}),e)}))),[]);Object(n.useEffect)((function(){b(),d(!1)}),[b,e.toggleNewPost]);var p=i.map((function(e){return Object(O.jsx)(k,{id:e.id,text:e.text,imageURL:e.imageURL,userId:e.userId,displayName:e.displayName,likes:e.likes},e.id)})).reverse();return Object(O.jsx)("div",{className:"post-list-container",children:u?Object(O.jsx)(T.a,{type:"TailSpin",color:"#585d99",height:100,width:100}):Object(O.jsx)("div",{children:p})})}),F=function(){var e=Object(n.useState)(!1),t=Object(j.a)(e,2),a=t[0],c=t[1];return Object(O.jsxs)("div",{children:[Object(O.jsx)(w,{sendPost:function(){c((function(e){return!e}))}}),Object(O.jsx)(C,{toggleNewPost:a})]})},J=(a(82),a.p+"static/media/edit.a609e087.svg"),Z=a.p+"static/media/tick.acf55764.svg",H=a.p+"static/media/close.195726a4.svg",V=function(e){var t=Object(d.h)(),a=Object(c.b)(),o=Object(n.useRef)(),i=Object(n.useState)(e.photoUrl),s=Object(j.a)(i,2),r=s[0],l=s[1],u=Object(n.useState)(e.displayName),f=Object(j.a)(u,2),b=f[0],p=f[1],h=Object(n.useState)(e.email),m=Object(j.a)(h,2),g=m[0],x=m[1],v=Object(n.useState)(b),N=Object(j.a)(v,2),I=N[0],_=N[1],y=Object(n.useState)(!1),E=Object(j.a)(y,2),k=E[0],D=E[1],T=Object(n.useState)(!1),U=Object(j.a)(T,2),L=U[0],w=U[1],P=Object(n.useState)(!1),A=Object(j.a)(P,2),R=A[0],C=A[1],F=Object(n.useState)(!1),V=Object(j.a)(F,2),z=V[0],M=V[1],G=Object(n.useState)(!0),B=Object(j.a)(G,2),X=B[0],q=B[1];Object(n.useEffect)((function(){p(e.displayName),x(e.email),l(e.photoUrl)}),[e.displayName,e.photoUrl,e.email]);var W=localStorage.getItem("token"),$=localStorage.getItem("userId"),K=function(){q(!0),M((function(e){return!e}))},Y=function(){C(!1),l(localStorage.getItem("photoUrl")),w((function(e){return!e}))},Q=function(e){fetch("https://react-http-560ff-default-rtdb.firebaseio.com/users/".concat($,".json?auth=").concat(W),{method:"PATCH",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}}).then((function(e){if(e.ok)return e.json();e.json().then((function(e){}))})).then((function(e){a({type:"SET_USER_INFO",payload:{displayName:localStorage.getItem("displayName"),photoUrl:localStorage.getItem("photoUrl")}})})).catch((function(e){console.log(e.message)}))};return Object(O.jsxs)("div",{className:"profile",children:[Object(O.jsx)("div",{className:"profile-image-side",children:Object(O.jsxs)("div",{className:"profile-image",children:[k?Object(O.jsx)("p",{children:"Loading..."}):Object(O.jsx)("img",{src:r,alt:"avatar"}),"/profile"===t.pathname&&Object(O.jsxs)("div",{className:"profile-image-photo-edit",children:[L?Object(O.jsx)("input",{type:"file",name:"avatar",accept:"image/png, image/jpeg, image/jpg",ref:o,onChange:function(e){D(!0);var t=e.target.files[0];C(!0);var a=S.storage().ref().child("avatars/".concat($,"/").concat(t.name)).put(t);a.on(S.storage.TaskEvent.STATE_CHANGED,(function(e){}),(function(e){throw e}),(function(){a.snapshot.ref.getDownloadURL().then((function(e){l(e),D(!1)}))}))}}):Object(O.jsx)("button",{className:"profile-chnage-photo-button",onClick:Y,children:"Change photo"}),L&&Object(O.jsxs)("div",{className:"profile-edit-photo-buttons-div",children:[R&&Object(O.jsx)("button",{className:"profile-edit-name-button",onClick:function(e){localStorage.removeItem("photoURL"),localStorage.setItem("photoUrl",r),Q({photoUrl:r}),w(!1)},children:Object(O.jsx)("img",{src:Z})}),Object(O.jsx)("button",{className:"profile-edit-name-button",onClick:Y,children:Object(O.jsx)("img",{src:H})})]})]})]})}),Object(O.jsxs)("div",{className:"profile-info",children:[Object(O.jsxs)("div",{className:"profile-edit-name",children:[z&&"/profile"===t.pathname?Object(O.jsx)("input",{type:"text",value:I,onChange:function(e){_(e.target.value)}}):Object(O.jsx)("div",{className:"profile-name",children:b}),"/profile"===t.pathname&&Object(O.jsx)("div",{children:z?Object(O.jsxs)("div",{className:"profile-edit-name-buttons-div",children:[Object(O.jsx)("button",{className:"profile-edit-name-button",onClick:function(){var e;(e=I).length<21&&e.length>0?(q(!0),localStorage.removeItem("displayName"),localStorage.setItem("displayName",I),Q({displayName:I}),K(),p(I)):q(!1)},children:Object(O.jsx)("img",{src:Z})}),Object(O.jsx)("button",{className:"profile-edit-name-button",onClick:K,children:Object(O.jsx)("img",{src:H})})]}):Object(O.jsx)("button",{className:"profile-edit-name-button",onClick:K,children:Object(O.jsx)("img",{src:J})})})]}),z&&!X&&Object(O.jsx)("p",{div:!0,className:"profile-name-error",children:"Name has to be shorter than 20 characters and atleast 1 character."}),Object(O.jsx)("div",{className:"profile-email",children:g})]})]})},z=function(){Object(d.g)();var e=Object(n.useState)(Object(c.c)((function(e){return e.userInfo.photoUrl}))),t=Object(j.a)(e,2),a=t[0],o=t[1],i=Object(c.c)((function(e){return e.userInfo.displayName})),s=Object(n.useState)(Object(c.c)((function(e){return e.userInfo.displayName}))),r=Object(j.a)(s,2),l=r[0],u=r[1],f=Object(n.useState)(Object(c.c)((function(e){return e.userInfo.email}))),p=Object(j.a)(f,2),h=p[0],m=p[1],g=Object(n.useState)(!0),x=Object(j.a)(g,2),v=x[0],N=x[1],I=Object(d.h)(),S=localStorage.getItem("token"),_=I.pathname.slice(6,I.pathname.length);return Object(n.useEffect)((function(){"/profile"!==I.pathname?(N(!0),fetch("https://react-http-560ff-default-rtdb.firebaseio.com/users/".concat(_,".json?auth=").concat(S)).then((function(e){if(e.ok)return e.json();console.log(e),e.json().then((function(e){}))})).then((function(e){u(e.displayName),m(e.email),""===e.photoUrl?o(b):o(e.photoUrl),N(!1)})).catch((function(e){console.log(e.message)}))):N(!1)}),[I,_,S]),Object(O.jsxs)("div",{children:[v?Object(O.jsx)("p",{children:"Loading"}):"/profile"===I.pathname?Object(O.jsx)(V,{displayName:i,email:localStorage.getItem("email"),photoUrl:localStorage.getItem("photoUrl")}):Object(O.jsx)(V,{displayName:l,email:h,photoUrl:a}),v?Object(O.jsx)("p",{children:"Loading"}):Object(O.jsx)("div",{children:"/profile"===I.pathname?Object(O.jsx)(U,{displayName:i,ownProfile:!0}):Object(O.jsx)(U,{currentUserId:_,displayName:l,ownProfile:!1})})]})};var M=function(){var e=Object(c.c)((function(e){return e.isLoggedIn})),t=localStorage.getItem("userId");return Object(O.jsxs)("main",{children:[Object(O.jsx)(g,{}),Object(O.jsxs)(d.d,{children:[Object(O.jsxs)(d.b,{path:"/",exact:!0,children:[!e&&Object(O.jsx)(d.a,{to:"/login",children:Object(O.jsx)(N,{})}),e&&Object(O.jsx)(d.a,{to:"/feed",children:Object(O.jsx)(F,{})})]}),!e&&Object(O.jsx)(d.b,{path:"/login",children:Object(O.jsx)(N,{})}),!e&&Object(O.jsx)(d.b,{path:"/signup",children:Object(O.jsx)(N,{})}),e&&Object(O.jsx)(d.b,{path:"/profile",children:Object(O.jsx)(z,{})}),e&&Object(O.jsx)(d.b,{path:"/feed",children:Object(O.jsx)(F,{})}),e&&Object(O.jsx)(d.b,{path:"/user/".concat(t),children:Object(O.jsx)(d.a,{to:"/profile"})}),e&&Object(O.jsx)(d.b,{path:"/user",children:Object(O.jsx)(z,{})}),Object(O.jsx)(d.b,{path:"*",children:Object(O.jsx)(d.a,{to:"/"})})]})]})};u.a.render(Object(O.jsx)(c.a,{store:r,children:Object(O.jsx)(f.a,{children:Object(O.jsx)(M,{})})}),document.getElementById("root"))}},[[83,1,2]]]);
//# sourceMappingURL=main.3f00ff8b.chunk.js.map